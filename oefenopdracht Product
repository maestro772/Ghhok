Controller
check of d e naam gevingen goed zijn

using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using Voedselbank.Models;

namespace Voedselbank.Controllers
{
    public class ProductController
    {
        private readonly string _connectionString;

        public ProductController(string connectionString)
        {
            _connectionString = connectionString;
        }

        public List<ProductModel> GetAll()
        {
            var producten = new List<ProductModel>();

            using (SqlConnection conn = new SqlConnection(_connectionString))
            using (SqlCommand cmd = new SqlCommand(@"
                SELECT ProductId, ProductNaam, PortiesPerEenheid, Voorraad, Actief, CategorieId, LeverancierId
                FROM Product
                ORDER BY ProductNaam", conn))
            {
                conn.Open();
                using (SqlDataReader reader = cmd.ExecuteReader())
                {
                    while (reader.Read())
                    {
                        producten.Add(new ProductModel
                        {
                            ProductId = Convert.ToInt32(reader["ProductId"]),
                            ProductNaam = reader["ProductNaam"].ToString(),
                            PortiesPerEenheid = Convert.ToInt32(reader["PortiesPerEenheid"]),
                            Voorraad = Convert.ToInt32(reader["Voorraad"]),
                            Actief = Convert.ToBoolean(reader["Actief"]),
                            CategorieId = Convert.ToInt32(reader["CategorieId"]),
                            LeverancierId = Convert.ToInt32(reader["LeverancierId"])
                        });
                    }
                }
            }

            return producten;
        }

        public ProductModel GetById(int productId)
        {
            ProductModel product = null;

            using (SqlConnection conn = new SqlConnection(_connectionString))
            using (SqlCommand cmd = new SqlCommand(@"
                SELECT ProductId, ProductNaam, PortiesPerEenheid, Voorraad, Actief, CategorieId, LeverancierId
                FROM Product
                WHERE ProductId = @ProductId", conn))
            {
                cmd.Parameters.AddWithValue("@ProductId", productId);

                conn.Open();
                using (SqlDataReader reader = cmd.ExecuteReader())
                {
                    if (reader.Read())
                    {
                        product = new ProductModel
                        {
                            ProductId = Convert.ToInt32(reader["ProductId"]),
                            ProductNaam = reader["ProductNaam"].ToString(),
                            PortiesPerEenheid = Convert.ToInt32(reader["PortiesPerEenheid"]),
                            Voorraad = Convert.ToInt32(reader["Voorraad"]),
                            Actief = Convert.ToBoolean(reader["Actief"]),
                            CategorieId = Convert.ToInt32(reader["CategorieId"]),
                            LeverancierId = Convert.ToInt32(reader["LeverancierId"])
                        };
                    }
                }
            }

            return product;
        }

        public int Add(ProductModel product)
        {
            using (SqlConnection conn = new SqlConnection(_connectionString))
            using (SqlCommand cmd = new SqlCommand(@"
                INSERT INTO Product (ProductNaam, PortiesPerEenheid, Voorraad, Actief, CategorieId, LeverancierId)
                VALUES (@ProductNaam, @PortiesPerEenheid, @Voorraad, @Actief, @CategorieId, @LeverancierId);
                SELECT SCOPE_IDENTITY();", conn))
            {
                cmd.Parameters.AddWithValue("@ProductNaam", product.ProductNaam);
                cmd.Parameters.AddWithValue("@PortiesPerEenheid", product.PortiesPerEenheid);
                cmd.Parameters.AddWithValue("@Voorraad", product.Voorraad);
                cmd.Parameters.AddWithValue("@Actief", product.Actief);
                cmd.Parameters.AddWithValue("@CategorieId", product.CategorieId);
                cmd.Parameters.AddWithValue("@LeverancierId", product.LeverancierId);

                conn.Open();
                return Convert.ToInt32(cmd.ExecuteScalar());
            }
        }

        public bool Update(ProductModel product)
        {
            using (SqlConnection conn = new SqlConnection(_connectionString))
            using (SqlCommand cmd = new SqlCommand(@"
                UPDATE Product
                SET ProductNaam = @ProductNaam,
                    PortiesPerEenheid = @PortiesPerEenheid,
                    Voorraad = @Voorraad,
                    Actief = @Actief,
                    CategorieId = @CategorieId,
                    LeverancierId = @LeverancierId
                WHERE ProductId = @ProductId", conn))
            {
                cmd.Parameters.AddWithValue("@ProductId", product.ProductId);
                cmd.Parameters.AddWithValue("@ProductNaam", product.ProductNaam);
                cmd.Parameters.AddWithValue("@PortiesPerEenheid", product.PortiesPerEenheid);
                cmd.Parameters.AddWithValue("@Voorraad", product.Voorraad);
                cmd.Parameters.AddWithValue("@Actief", product.Actief);
                cmd.Parameters.AddWithValue("@CategorieId", product.CategorieId);
                cmd.Parameters.AddWithValue("@LeverancierId", product.LeverancierId);

                conn.Open();
                return cmd.ExecuteNonQuery() > 0;
            }
        }

        public bool Delete(int productId)
        {
            using (SqlConnection conn = new SqlConnection(_connectionString))
            using (SqlCommand cmd = new SqlCommand(@"
                DELETE FROM Product
                WHERE ProductId = @ProductId", conn))
            {
                cmd.Parameters.AddWithValue("@ProductId", productId);

                conn.Open();
                return cmd.ExecuteNonQuery() > 0;
            }
        }
    }
}





-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------





Hieronder krijg je 3 bestanden (simpel, klaar om te plakken):

frmProduct.cs → overzicht + listview vullen + nav knoppen + toevoegen/bewerken/verwijderen

frmProductToevoegen.cs → maakt nieuw product aan (Insert)

frmProductBewerken.cs → bewerkt geselecteerd product (Update)

✅ Je model blijft EXACT hetzelfde.



1) frmProduct.cs (Overzicht)



using System;
using System.Collections.Generic;
using System.Configuration;
using System.Windows.Forms;
using Voedselbank.Controllers;
using Voedselbank.Models;

namespace Voedselbankk.View
{
    public partial class frmProduct : Form
    {
        private ProductController productController;

        public frmProduct()
        {
            InitializeComponent();

            string connStr = ConfigurationManager.ConnectionStrings["VoedselbankDB"].ConnectionString;
            productController = new ProductController(connStr);
        }

        private void frmProduct_Load(object sender, EventArgs e)
        {
            lvProducten.Columns.Clear();
            lvProducten.Columns.Add("Id", 60);
            lvProducten.Columns.Add("Naam", 200);
            lvProducten.Columns.Add("Porties", 70);
            lvProducten.Columns.Add("Voorraad", 80);
            lvProducten.Columns.Add("Actief", 60);
            lvProducten.Columns.Add("Categorie", 80);
            lvProducten.Columns.Add("Leverancier", 90);

            lvProducten.FullRowSelect = true;
            lvProducten.View = View.Details;

            VulListView();
        }

        private void VulListView()
        {
            lvProducten.Items.Clear();

            List<ProductModel> producten = productController.GetAll();

            if (producten == null || producten.Count == 0)
            {
                // mag je weglaten als je geen popup wil
                // MessageBox.Show("Geen producten gevonden.");
                return;
            }

            foreach (ProductModel product in producten)
            {
                ListViewItem item = new ListViewItem(product.ProductId.ToString());
                item.SubItems.Add(product.ProductNaam);
                item.SubItems.Add(product.PortiesPerEenheid.ToString());
                item.SubItems.Add(product.Voorraad.ToString());
                item.SubItems.Add(product.Actief ? "Ja" : "Nee");
                item.SubItems.Add(product.CategorieId.ToString());
                item.SubItems.Add(product.LeverancierId.ToString());

                item.Tag = product; // belangrijk voor bewerken/verwijderen
                lvProducten.Items.Add(item);
            }
        }

        private void btnToevoegen_Click(object sender, EventArgs e)
        {
            frmProductToevoegen form = new frmProductToevoegen(productController);
            form.ShowDialog();
            VulListView();
        }

        private void btnBewerken_Click(object sender, EventArgs e)
        {
            if (lvProducten.SelectedItems.Count == 0)
            {
                MessageBox.Show("Selecteer eerst een product om te bewerken.");
                return;
            }

            var selectedItem = lvProducten.SelectedItems[0];
            var product = selectedItem.Tag as ProductModel;

            if (product == null)
            {
                MessageBox.Show("Ongeldig product geselecteerd.");
                return;
            }

            frmProductBewerken bewerkenForm = new frmProductBewerken(productController, product);

            bewerkenForm.FormClosed += (s, args) =>
            {
                VulListView();
            };

            bewerkenForm.ShowDialog();
        }

        private void btnVerwijderen_Click(object sender, EventArgs e)
        {
            if (lvProducten.SelectedItems.Count == 0)
            {
                MessageBox.Show("Selecteer eerst een product.");
                return;
            }

            var selectedItem = lvProducten.SelectedItems[0];
            var product = selectedItem.Tag as ProductModel;

            if (product == null)
            {
                MessageBox.Show("Ongeldig product geselecteerd.");
                return;
            }

            var confirm = MessageBox.Show(
                $"Weet je zeker dat je '{product.ProductNaam}' wilt verwijderen?",
                "Bevestig verwijdering",
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning
            );

            if (confirm == DialogResult.Yes)
            {
                bool success = productController.Delete(product.ProductId);

                if (success)
                {
                    MessageBox.Show("Product succesvol verwijderd.");
                    VulListView();
                }
                else
                {
                    MessageBox.Show("Verwijderen mislukt.");
                }
            }
        }

        private void btnProducten_Click(object sender, EventArgs e)
        {
            // je zit al op Producten
            VulListView();
        }

        private void btnLeveranciers_Click(object sender, EventArgs e)
        {
            frmLeveranciers f = new frmLeveranciers();
            f.Show();
            this.Hide();
        }

        private void btnLeveringen_Click(object sender, EventArgs e)
        {
            frmLevering f = new frmLevering();
            f.Show();
            this.Hide();
        }

        private void btnGrafiek_Click(object sender, EventArgs e)
        {
            frmGrafiek f = new frmGrafiek();
            f.Show();
            this.Hide();
        }

        private void lvProducten_SelectedIndexChanged(object sender, EventArgs e)
        {
        }

        private void btnFilter_Click(object sender, EventArgs e)
        {
            // niet gebruiken
        }
    }
}


---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


2) frmProductToevoegen.cs (Insert)





Deze form moet inputs hebben zoals:
txtNaam, nudPorties, nudVoorraad, chkActief, nudCategorieId, nudLeverancierId, btnOpslaan, btnAnnuleren

using System;
using System.Windows.Forms;
using Voedselbank.Controllers;
using Voedselbank.Models;

namespace Voedselbankk.View
{
    public partial class frmProductToevoegen : Form
    {
        private ProductController productController;

        public frmProductToevoegen(ProductController controller)
        {
            InitializeComponent();
            productController = controller;
        }

        private void btnOpslaan_Click(object sender, EventArgs e)
        {
            try
            {
                ProductModel product = new ProductModel
                {
                    ProductNaam = txtNaam.Text.Trim(),
                    PortiesPerEenheid = (int)nudPorties.Value,
                    Voorraad = (int)nudVoorraad.Value,
                    Actief = chkActief.Checked,
                    CategorieId = (int)nudCategorieId.Value,
                    LeverancierId = (int)nudLeverancierId.Value
                };

                if (string.IsNullOrWhiteSpace(product.ProductNaam))
                {
                    MessageBox.Show("Productnaam is verplicht.");
                    return;
                }

                int newId = productController.Add(product);

                if (newId > 0)
                {
                    MessageBox.Show("Product toegevoegd!");
                    this.Close();
                }
                else
                {
                    MessageBox.Show("Toevoegen mislukt.");
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show("Fout bij toevoegen: " + ex.Message);
            }
        }

        private void btnAnnuleren_Click(object sender, EventArgs e)
        {
            this.Close();
        }
    }
}


---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

3) frmProductBewerken.cs (Update)

Zelfde controls als toevoegen.

using System;
using System.Windows.Forms;
using Voedselbank.Controllers;
using Voedselbank.Models;

namespace Voedselbankk.View
{
    public partial class frmProductBewerken : Form
    {
        private ProductController productController;
        private ProductModel product;

        public frmProductBewerken(ProductController controller, ProductModel selectedProduct)
        {
            InitializeComponent();

            productController = controller;
            product = selectedProduct;

            // velden vullen
            txtNaam.Text = product.ProductNaam;
            nudPorties.Value = product.PortiesPerEenheid;
            nudVoorraad.Value = product.Voorraad;
            chkActief.Checked = product.Actief;
            nudCategorieId.Value = product.CategorieId;
            nudLeverancierId.Value = product.LeverancierId;
        }

        private void btnOpslaan_Click(object sender, EventArgs e)
        {
            try
            {
                product.ProductNaam = txtNaam.Text.Trim();
                product.PortiesPerEenheid = (int)nudPorties.Value;
                product.Voorraad = (int)nudVoorraad.Value;
                product.Actief = chkActief.Checked;
                product.CategorieId = (int)nudCategorieId.Value;
                product.LeverancierId = (int)nudLeverancierId.Value;

                if (string.IsNullOrWhiteSpace(product.ProductNaam))
                {
                    MessageBox.Show("Productnaam is verplicht.");
                    return;
                }

                bool success = productController.Update(product);

                if (success)
                {
                    MessageBox.Show("Product bijgewerkt!");
                    this.Close();
                }
                else
                {
                    MessageBox.Show("Bewerken mislukt.");
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show("Fout bij bewerken: " + ex.Message);
            }
        }

        private void btnAnnuleren_Click(object sender, EventArgs e)
        {
            this.Close();
        }
    }
}
=======================================================================================================================================================================================
App.config (moet)
<connectionStrings>
  <add name="VoedselbankDB"
       connectionString="Server=.\SQLEXPRESS;Database=JouwDatabaseNaam;Trusted_Connection=True;"
       providerName="System.Data.SqlClient" />
</connectionStrings>

Kleine check (zodat het meteen compileert)

Bestaan jouw forms exact zo?

frmLeveranciers

frmLevering (of heet hij frmLeveringen?)

frmGrafiek

frmProductToevoegen

frmProductBewerken

En hebben frmProductToevoegen en frmProductBewerken exact deze controlnamen?

txtNaam, nudPorties, nudVoorraad, chkActief, nudCategorieId, nudLeverancierId, btnOpslaan, btnAnnuleren


=================================================================================================================================================================

2) frmProductToevoegen (nieuw product maken)

Dit is een apart form dat opent als je op Toevoegen klikt.

Op dit form zet je controls (invoer):

TextBox → txtNaam

NumericUpDown → nudPorties

NumericUpDown → nudVoorraad

CheckBox → chkActief

NumericUpDown → nudCategorieId

NumericUpDown → nudLeverancierId

Buttons:

btnOpslaan

btnAnnuleren

✅ Hier komt code die bij btnOpslaan jouw ProductModel vult en productController.Add(product) doet.
✅ Bij btnAnnuleren → Close().

3) frmProductBewerken (bestaand product aanpassen)

Dit is een apart form dat opent als je op Bewerken klikt (met het geselecteerde product).

Op dit form zet je EXACT dezelfde controls als bij Toevoegen:

txtNaam

nudPorties

nudVoorraad

chkActief

nudCategorieId

nudLeverancierId

btnOpslaan

btnAnnuleren

✅ Hier vult de constructor eerst de velden met de gekozen ProductModel.
✅ btnOpslaan → Update(product).







